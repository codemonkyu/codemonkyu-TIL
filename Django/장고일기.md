### django 개념 공부하기

junkyu

junkyu

user password : userpasword1

-----

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-00-36-48-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-00-41-28-image.png)

* django MVT 구조 이해하기
  
  **- template : 우리 눈에 보이는 페이지를 만드는 곳 (frontend)**
  
  **- view : template에서 어떤 페이지를 어떻게 보여줄 지 처리해주는 곳 (중간에서 로직을 처리하는 곳)**
  
  **- model : 웹사이트에서 보여줄 정보들을 저장하는 곳을 정해주는 곳 (backend)**

* cmd에서 django-admin으로 subcommand 종류 확인할 수 있다.

[django]
    check
    compilemessages
    createcachetable
    dbshell
    diffsettings
    dumpdata
    flush
    inspectdb
    loaddata
    makemessages
    **makemigrations**
    **migrate**
    **runserver**
    sendtestemail
    **shell**
    showmigrations
    sqlflush
    sqlmigrate
    sqlsequencereset
    squashmigrations
    **startapp**
    **startproject**
    test
    testserver

---

#### [1]. 프로젝트 생성하기, 설정하기 ,template만들어주기

* django-admin startproject  프로젝트이름

* settings.py 설정 변경 (language_code, time_zone,정적파일경로추가)
  
  * 장고의 정적파일종류 2가지 [Django 19. 장고 정적파일(STATIC,MEDIA) - 대구 올빼미의 새벽 개발로그](https://fabl1106.github.io/django/2019/05/10/Django-19.-%EC%9E%A5%EA%B3%A0-%EC%A0%95%EC%A0%81%ED%8C%8C%EC%9D%BC(STATIC,MEDIA).html)

* python manage.py migrate (db생성)

* python manage.py runserver (서버시작)

* python manage.py createsuperuser (superuser) 계정 생성

* project urls.py 와 app urls.py 그리고 views.py의 관계 
  
  * URLConf : 장고에서 url과 일치하는 view를 찾기 위한 urlpatterns의 집합
  
  * 특정 url과 view 매핑 list
    
    * myproject의 urls.py 
      
      ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-02-29-16-image.png)
      
      *app discord의 urls을 include 해준다. 왜 ? 어떤 path가 오더라도 discord의 urls와 연결*
    
    * discord app의 urls.py
      
      ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-03-04-55-image.png)

* Templates 경로 설정하기 

* main Templates 만들어주기

* 변수사용하기

----

### startpoject 구성

* manage.py : 웹사이트 관리를 도와주는 역할을 하는 파일
  • settings.py : 웹사이트 설정이 있는 파일
  • urls.py : urlresolver가 사용하는 요청 패턴(URL규칙) 목록을
  포함하고 있는 파일
  • wsgi.py : Web Server Gateway Interface이며 Python의 표준
  Gateway Interface 입니다.
  • asgi.py : Asynchronous Server Gateway Interface
  WSGI와 비슷한 구조를 가지며, 비동기 통신을 지원한다.

---

### Templates 경로 설정하기

1.Templates 폴더를 만들어주고 project setting.py에 TEMPLATES에 추가

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-02-56-58-image.png)

2. 전 VS 후

view.py 에서

전

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-02-58-52-image.png)

후

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-03-00-56-image.png)

#### 정리 :

1.프로젝트의 setting.py의 TEMPLATES 에 새로만든 templates 폴더를 경로로 설정

 2.프로젝트의 urls.py에서 urlpatterns에 discord앱의 urls.py를 연동 

*include('discord.urls')* 로 dicscrod앱의 urls.py를 조회하도록 한다. 

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-02-29-16-image.png)

3. 기본 로컬 주소로 들어가면 view.home으로 보이게 한다. 왜 
   
   ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-03-04-55-image.png)
   
   (앱)discord urls.py에 이렇게 줬으니까! 
   
   -------
   
   ### main template.html 만들어주기

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-13-47-45-image.png)

##### html 정리

1.<head>와 </head>사이는 페이지를 열때 브라우저에 표시되는 <body>요소와 

다르게 페이지에표시되지 않는다.

예를들어, <h1>요소와 <title>요소를 헷갈리지말자 

- [`<h1>`](https://developer.mozilla.org/ko/docs/Web/HTML/Element/Heading_Elements) 요소는 일반적으로 페이지당 한 번 씩 사용되는데, 페이지 내용물의 제목이나 뉴스의 헤드라인을 표시하기 위해서 페이지를 열 때 브라우저에 표시됩니다.
- [`<title>`](https://developer.mozilla.org/ko/docs/Web/HTML/Element/title)은 (문서의 컨텐츠가 아니라)  HTML문서 전체의 타이틀 표현하기 위한 메타데이터입니다

2.메타데이터:<meta>요소

* 메타데이터는 데이터를 설명하는 데이터이다 그리고 HTML에서 문서에 공식적으로 메타데이터를 적용하는 방법이 있습니다. — the [`<meta>`](https://developer.mozilla.org/ko/docs/Web/HTML/Element/meta) 요소.

3.character set - utf -8

* 이 요소는 문서의 character—문서에서 허용하는 문자 집합(character set)— encoding에 대해서 간단히 표시합니다 . `utf-8` 은 전세계적인 character 집합으로 많은 언어들을 문자들을 포함합니다.

4. `<meta>` 요소가 `name` 과 `content` 속성을 가진다.

- `name` 은 메타 요소가 어떤 정보의 형태를 갖고 있는지 알려줍니다.
- `content`는 실제 메타데이터의 컨텐츠입니다.
- ```
  <meta name="author" content="Chris Mills">
  <meta name="description" content="The MDN Learning Area aims to providecomplete beginners to the Web with all they need to know to getstarted with developing web sites and applications.">
  ```

5.맞춤아이콘추가하기 

```
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
```

6.HTML에 CSS와 Javascript적용하기 

* [`<link>`](https://developer.mozilla.org/ko/docs/Web/HTML/Element/link)는 항상 문서의 head 부분에 위치한다. 이것은 두 가지 속성을 취하는데, rel="stylesheet", 즉 문서의 스타일 시트임을 나타냄과 동시에 스타일 시트 파일의 경로를 포함하는 href를 내포한다.

```
<link rel="stylesheet" href="my-css-file.css">
```

* [`<script>`](https://developer.mozilla.org/ko/docs/Web/HTML/Element/script) 는 head에 들어갈 필요가 없다. `</body>` 태그 바로 앞, 문서 본문의 맨 끝에 넣는 것이 좋으며, JavaScript를 적용하기 전에 모든 HTML 내용을 브라우저에서 읽었는지 확인하는 것이 좋다. 액세스 과정에서 JavaScript가 아직 존재하지 않는 요소라고 판단하며 에러가 날 수 있다.

```
<script src="my-js-file.js"></script>
```

*어라? 나는 이제보니까 head에 넣어놓았네 별이상없으면 그대로해보자*

*지금 단계에서는 css/js파일이 없으니까 주석처리해놓고 나중에 바꾸자*

7.문서의 기본언어 설정 

전체 페이지의 언어를 설정 / 문서의 하위섹션의 언어를 다르게 설정할 수 있다.

* ```
  <html lang="en-US">
  ```

* ```
  <p>Japanese example: <span lang="jp">ご飯が熱い。</span>.</p>
  ```

----

#### {%block content%} {%endblock%}으로 maintemplate연결해주기

1. main.html의 body부분을 {%block content%} {%endblock%}으로감싸준다.

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-06-13-image.png)

2. home.html에 {%extends ' '%}를 사용해서 연결해준다.

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-07-24-image.png)

이제 **home.html**의 {%block content%} {%endblock%}사이의 content는**main.html**에연동된다. 때문에 navbar.html은 항상 나타난다.

----

#### template에 변수사용하기

#### 변수 [¶](https://docs.djangoproject.com/en/4.0/topics/templates/#variables "이 헤드라인에 대한 영구 링크")

변수는 키를 값으로 매핑하는 사전과 같은 객체인 컨텍스트에서 값을 출력합니다.

`{{`변수는 다음 과 `}}`같이 둘러싸여 있습니다 .

My first name is **{{ first_name }}**. My last name is **{{ last_name }}.**

의 컨텍스트 에서 이 템플릿은 다음과 같이 렌더링됩니다.`

{'first_name': 'John', 'last_name': 'Doe'}`

My first name is  **John.** 

My last name is **Doe.**

사전 조회, 속성 조회 및 목록 색인 조회는 점 표기법으로 구현됩니다.

{{ my_dict.key }}
{{ my_object.attribute }}
{{ my_list.0 }}

변수가 콜러블로 확인되면 템플릿 시스템은 인수 없이 변수를 호출하고 콜러블 대신 결과를 사용합니다.

* 예시

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-34-03-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-42-53-image.png)

context를 변수로주어서도 사용가능

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-34-22-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-14-34-35-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-15-02-21-image.png)

room/ <str:pk>로 받아 room/1,2,3,4,5 등의 주소로 room.html을 불러올수있다.

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-15-03-38-image.png)

view.py의 room함수에 인자 pk를 더해준다 .

{%url name  pk}

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-15-27-02-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-15-27-23-image.png)

* html 태그정리

* - `<h1>A heading</h1>` - 큰 제목
  - `<h2>A sub-heading</h2>` - 중 제목
  - `<h3>A sub-sub-heading</h3>` - 소 제목... `<h6>`레벨까지 사용할 수 있습니다.
  - `<em>text</em>` - 텍스트 기울기 (Italic)
  - `<strong>text</strong>` - 텍스트를 두껍게(Bold)
  - `<br />` - 줄바꿈 (br은 스스로 닫히는 태그로 속성을 사용할 수 없습니다)
  - `<a href="http://djangogirls.org">link</a>` - 하이퍼링크 걸기
  - `<ul><li>first item</li><li>second item</li></ul>`- 목록 만들기
  - `<div></div>` - 페이지 섹션
  - `<p></p>` 태그는 paragraph, 즉 문단의 약자로, 하나의 문단을 만들 때 쓰입니다.

#### 여기까지 templates와 view, url의 관계에대해서 정리해보았다.

* 간단요약

view.py에 함수를 만들어 urls에 따라 보여주는 template를  연결해주는것이다. 

client -> urlconf-> view -> template ->client

---

### [2].models 만들어주기

* class를 이용한 django models

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-15-49-23-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-20-33-image.png)

class를 사용해서 사용할 model을 만들어주고

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-20-40-image.png)

admin에 등록해준다 .

----

### QUERYSET

* 구조

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-25-42-image.png)

#### queryset list(*필요할때마다 보자*)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-27-59-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-28-50-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-29-02-image.png)

하나의 모델에 여러개의 class를 정의할 수 있음

예를들어, 사용자는 여러개의 리뷰를 작성할 수 있음 대신 그 리뷰들은 모두 하나의 사용자들에게 속해져있어야하기 때문

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-37-47-image.png)

일대다 형식이 되도록 class를 설정해주었는데 이해가 잘 가지 않는다.  

1.왜 ForeignKey를 사용하지 ?

2.왜 CASCADE를 사용하고 어떤것은 SET_NULL을 사용하지 ?

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-16-58-51-image.png)

*흠 ... 아직 장고의 웹페이지 구현방식을 100%이해하지 못한것같다. 천천히 다시 정리하자*

---

#### forms.py 만들기

* submit단추를 만들고나서 form을 만들어주려고한다. 먼저 form.py를 만들어주고 model의 class Room을 갖고와서 form을 만들어주자 !!

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-20-54-58-image.png)

이를 view.py의 def createRoom과 연결해준다 .

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-20-58-11-image.png)

마지막으로 room_form.html에 넣어준다 .

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-20-55-48-image.png)

### Form vs Model Form (폼과 모델폼의 차이)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-21-46-53-image.png)

------

#### 장고일기

*장고 일기를 쓰면서 내 나름대로 part를 나누어서 정리하려고했지만 오히려 내용이 섞이고 그때그때 필요한 내용을 분류하기가 어려워서 복잡해져버렸다. 때문에 이제부터는 구현하는 기능위주로 설명하고 구현할때 필요한 코드,방식등을 정리해야겠다.

----

* delete 버튼 만들기

delete.html

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-23-42-29-image.png)

->{{request.META.HTTP_REFERER}}을 통해 이전 페이지로 이동가능 

views.py

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-17-23-43-22-image.png)

* container 기능 사용하기

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-18-01-19-43-image.png)

-> class " home - container"를 만들어주면 .home-container로 편하게 style가능

* ALL 버튼 (모든 목록불러오기) 구현하기 
  
  * icontains 활용
  
  ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-18-23-51-19-image.png)
  
  * ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-18-23-51-40-image.png) 이렇게 뒤에 아무런 주소 (none)오지 않을때는 q로 받는건 다 보여줘라 또는 특정 q를 받을때는 또 그 q가 갖고있는것을 보여줘라 
  
  * 위 와같이 all조회 및 다른 특정 카테고리 조회가 가능함

* search 기능 구현하기 (placeholder사용)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-00-50-09-image.png)

navbar.html에 placeholder

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-02-36-21-image.png)

view.py 의 home 함수 설정으로 home.html에서 name, topicname,description에 대한 내용으로 search가능하도록 만듬 

* room(채팅방) 숫자 세기 기능 구현하기 

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-03-03-07-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-03-03-16-image.png)

비교적쉽게 구현가능했다.

* **로그인시 생겨나는 token의 개념 (login 기능구현)**

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-03-02-53-image.png)

* login register .html 을 만들려고한다 . 

<form> 태그의 action 속성은 폼 데이터(form data)를 서버로 보낼 때 해당 데이터가 도착할 URL을 명시합니다.

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-14-01-22-image.png)

그리고 html에 로그인시 필요한 username과 password를 입력하는 곳을 만들어준다 .

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-14-06-12-image.png)

다음으로 view.py에 html에해당하는 정보를 갖고오는 함수를 만들어준다.

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-18-13-05-image.png)

* 장고의 기본인증시스템으로 로그인 구현하기 

장고 프로젝트를 생성하면 우리는 **settings.py**의 **INSTALLED_APPS**에 django.contrib.auth와 django.contrib.contenttypes 가 기본으로 등록되어 있는데 이것이 바로 장고에서 제공하는 기본 인증 시스템이다.   

![](https://blog.kakaocdn.net/dn/bgNA8O/btqLhP0Eh8r/yWqhaK436fISDbFp75UIoK/img.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-23-45-06-image.png)

1. django.contrib.auth의 authenticate 기능 view.py의 def loginPage 에 user변수를 정의해주고 user의 값이 None이 아니면 login하고 홈으로 가주고 그렇지 않을 경우에는 에러메세지를 띄어준다

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-23-38-40-image.png)

2. logout

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-23-50-22-image.png)

3. narvar.html에 기능을 나타내고싶다

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-19-23-50-58-image.png)

* login_required로 기능을 사용하기위해 로그인 조건 걸기
  
  ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-00-23-54-image.png)
1. login_required 를 improt 해주기 

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-00-24-33-image.png)

2. 원하는 기능 *함수* 앞에 @login_required(로그인주소)로 조건걸어주기
* usercreationfrom 이용하기 

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-13-45-05-image.png)

1. 원하는 page에 form 삽입 

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-13-46-31-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-13-47-30-image.png)

![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-13-47-38-image.png)

* form에서 commit=False는 무슨기능 ..??

한줄요약 : `commit=False`를 하게 되면 데이터베이스에 `당장` 저장하지 않는다.

언제쓰지? : DB에 데이터를 저장하기 전에 특정 `행위`를 하고 싶을 때 사용한다..

즉, 저장을 늦게 시켜서 사용자가 원하는 추가적인 정보를 저장할 수 있는 것이라고 생각하면 된다.



* room.messages_set.all() 에대한 이해 
  
  ![](C:\Users\junkyu-laptop\AppData\Roaming\marktext\images\2022-02-20-21-04-17-image.png)`room.message_set.all()`= `Message.objects.filter(room=room)`.
